#include "yass.h"
#include <iostream>

bool testYASS(PatternScan::YASS scanner, char* buffer, int size)
{
	return scanner.Scan((uintptr_t)buffer, size);
}

int main()
{
	// Permutations of "MyNameIsScimmy"
	char test1[] = { 0x4d, 0x79, 0x4e, 0x61, 0x6d, 0x65, 0x49, 0x73, 0x53, 0x63, 0x69, 0x6d, 0x6d, 0x79 };
	char test2[] = { 0x4d, 0x79, 0x49, 0x73, 0x4e, 0x61, 0x6d, 0x65, 0x53, 0x63, 0x69, 0x6d, 0x6d, 0x79 };
	char test3[] = { 0x4e, 0x61, 0x6d, 0x65, 0x4d, 0x79, 0x49, 0x73, 0x53, 0x63, 0x69, 0x6d, 0x6d, 0x79 };
	char test4[] = { 0x4e, 0x61, 0x6d, 0x65, 0x49, 0x73, 0x4d, 0x79, 0x53, 0x63, 0x69, 0x6d, 0x6d, 0x79 };
	char test5[] = { 0x49, 0x73, 0x4d, 0x79, 0x4e, 0x61, 0x6d, 0x65, 0x53, 0x63, 0x69, 0x6d, 0x6d, 0x79 };
	char test6[] = { 0x49, 0x73, 0x4e, 0x61, 0x6d, 0x65, 0x4d, 0x79, 0x53, 0x63, 0x69, 0x6d, 0x6d, 0x79 };
	char test7[] = "ThisWillFail";

	PatternScan::YASS yass({ "\x4d\x79", "\x4e\x61\x6d\x65", "\x49\x73" }, { "xx", "x??x", "xx" });

	assert(testYASS(yass, test1, sizeof(test1)));
	assert(testYASS(yass, test2, sizeof(test2)));
	assert(testYASS(yass, test3, sizeof(test3)));
	assert(testYASS(yass, test4, sizeof(test4)));
	assert(testYASS(yass, test5, sizeof(test5)));
	assert(testYASS(yass, test6, sizeof(test6)));
	assert(!testYASS(yass, test7, sizeof(test7)));

	std::cout << "All tests passed!" << std::endl;
	system("pause");
}